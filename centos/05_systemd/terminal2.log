[vagrant@centos ~]$ 
[vagrant@centos ~]$ 
[vagrant@centos ~]$ sudo yum install epel-release -y && sudo yum install spawn-fcgi php php-cli -y
Failed to set locale, defaulting to C
Loaded plugins: fastestmirror
Loading mirror speeds from cached hostfile
 * base: centos-mirror.rbc.ru
 * extras: mirror.docker.ru
 * updates: mirror.corbina.net
 ...
 Complete!
[vagrant@centos ~]$ 
[vagrant@centos ~]$ 
[vagrant@centos ~]$ sudo cat /etc/sysconfig/spawn-fcgi

# You must set some working options before the "spawn-fcgi" service will work.
# If SOCKET points to a file, then this file is cleaned up by the init script.
#
# See spawn-fcgi(1) for all possible options.
#
# Example :
SOCKET=/var/run/php-fcgi.sock
OPTIONS="-u apache -g apache -s $SOCKET -S -M 0600 -C 32 -F 1 -P /var/run/spawn-fcgi.pid -- /usr/bin/php-cgi"

[vagrant@centos ~]$ 
[vagrant@centos ~]$ 
[vagrant@centos ~]$ sudo cat /etc/systemd/system/spawn-fcgi.service

[Unit]
Description=Spawn-fcgi startup service by Otus
After=network.target

[Service]
Type=simple
PIDFile=/var/run/spawn-fcgi.pid
EnvironmentFile=/etc/sysconfig/spawn-fcgi
ExecStart=/usr/bin/spawn-fcgi -n $OPTIONS
KillMode=process

[Install]
WantedBy=multi-user.target

[vagrant@centos ~]$ 
[vagrant@centos ~]$ 
[vagrant@centos ~]$ sudo systemctl start spawn-fcgi
[vagrant@centos ~]$ 
[vagrant@centos ~]$ 
[vagrant@centos ~]$ sudo systemctl status spawn-fcgi
● spawn-fcgi.service - Spawn-fcgi startup service by Otus
   Loaded: loaded (/etc/systemd/system/spawn-fcgi.service; disabled; vendor preset: disabled)
   Active: active (running) since Wed 2023-11-15 17:51:41 UTC; 7s ago
 Main PID: 4861 (php-cgi)
    Tasks: 33 (limit: 4952)
   Memory: 19.0M
   CGroup: /system.slice/spawn-fcgi.service
           ├─4861 /usr/bin/php-cgi
           ├─4862 /usr/bin/php-cgi
           ├─4863 /usr/bin/php-cgi
           ├─4864 /usr/bin/php-cgi
           ├─4865 /usr/bin/php-cgi
           ├─4866 /usr/bin/php-cgi
           ├─4867 /usr/bin/php-cgi
           ├─4868 /usr/bin/php-cgi
           ├─4869 /usr/bin/php-cgi
           ├─4870 /usr/bin/php-cgi
           ├─4871 /usr/bin/php-cgi
           ├─4872 /usr/bin/php-cgi
           ├─4873 /usr/bin/php-cgi
           ├─4874 /usr/bin/php-cgi
           ├─4875 /usr/bin/php-cgi
           ├─4876 /usr/bin/php-cgi
[vagrant@centos ~]$ 
[vagrant@centos ~]$ 
[vagrant@centos ~]$ sudo cat /usr/lib/systemd/system/httpd.service

[Unit]
Description=The Apache HTTP Server
Wants=httpd-init.service

After=network.target remote-fs.target nss-lookup.target httpd-init.service

Documentation=man:httpd.service(8)

[Service]
Type=notify
Environment=LANG=C
EnvironmentFile=/etc/sysconfig/httpd-%I
ExecStart=/usr/sbin/httpd $OPTIONS -DFOREGROUND
ExecReload=/usr/sbin/httpd $OPTIONS -k graceful
# Send SIGWINCH for graceful stop
KillSignal=SIGWINCH
KillMode=mixed
PrivateTmp=true

[Install]
WantedBy=multi-user.target

[vagrant@centos ~]$ 
[vagrant@centos ~]$ 
[vagrant@centos ~]$ sudo touch /etc/sysconfig/httpd-first
[vagrant@centos ~]$ 
[vagrant@centos ~]$ 
[vagrant@centos ~]$ sudo cat /etc/sysconfig/httpd-first

OPTIONS=-f conf/first.conf

[vagrant@centos ~]$ 
[vagrant@centos ~]$ 
[vagrant@centos ~]$ sudo touch /etc/sysconfig/httpd-second
[vagrant@centos ~]$ 
[vagrant@centos ~]$ 
[vagrant@centos ~]$ sudo cat /etc/sysconfig/httpd-second

OPTIONS=-f conf/second.conf

[vagrant@centos ~]$ 
[vagrant@centos ~]$ 
[vagrant@centos ~]$ sudo touch /etc/httpd/conf/first.conf
[vagrant@centos ~]$ 
[vagrant@centos ~]$ 
[vagrant@centos ~]$ sudo cat /etc/httpd/conf/first.conf

LoadModule mpm_event_module modules/mod_mpm_event.so
PidFile /var/run/httpd-first.pid
ServerName localhost:8080
Listen 8080

[vagrant@centos ~]$ 
[vagrant@centos ~]$ 
[vagrant@centos ~]$ sudo touch /etc/httpd/conf/second.conf
[vagrant@centos ~]$ 
[vagrant@centos ~]$ 
[vagrant@centos ~]$ sudo cat /etc/httpd/conf/second.conf

LoadModule mpm_event_module modules/mod_mpm_event.so
PidFile /var/run/httpd-second.pid
ServerName localhost:8081
Listen 8081

[vagrant@centos ~]$ 
[vagrant@centos ~]$ 
[vagrant@centos ~]$ mv /usr/lib/systemd/system/httpd.service /usr/lib/systemd/system/httpd@.service
mv: replace '/usr/lib/systemd/system/httpd@.service', overriding mode 0644 (rw-r--r--)? 
[vagrant@centos ~]$ 
[vagrant@centos ~]$ 
[vagrant@centos ~]$ sudo cat /etc/selinux/config

# This file controls the state of SELinux on the system.
# SELINUX= can take one of these three values:
#     enforcing - SELinux security policy is enforced.
#     permissive - SELinux prints warnings instead of enforcing.
#     disabled - No SELinux policy is loaded.
SELINUX=disabled
# SELINUXTYPE= can take one of these three values:
#     targeted - Targeted processes are protected,
#     minimum - Modification of targeted policy. Only selected processes are protected. 
#     mls - Multi Level Security protection.
SELINUXTYPE=targeted

[vagrant@centos ~]$ 
[vagrant@centos ~]$ 




